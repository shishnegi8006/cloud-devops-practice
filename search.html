<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search - AWS Solution Architect Study Materials</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #232F3E 0%, #1a252f 100%);
            min-height: 100vh;
        }
        .search-container {
            background: rgba(17, 24, 39, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 153, 0, 0.2);
        }
        .search-result {
            background: rgba(31, 41, 55, 0.6);
            border-left: 4px solid #FF9900;
            backdrop-filter: blur(5px);
            transition: all 0.3s ease;
        }
        .search-result:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(255, 153, 0, 0.1);
        }
        .highlight {
            background-color: rgba(255, 153, 0, 0.3);
            padding: 1px 3px;
            border-radius: 2px;
        }
        .aws-orange { color: #FF9900; }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }
    </style>
</head>
<body class="text-white">
    <div class="w-full min-h-screen p-4 sm:p-6 lg:p-8">
        <!-- Navigation -->
        <div class="mb-6">
            <a href="index.html" class="inline-flex items-center text-aws-orange hover:text-white transition-colors text-sm sm:text-base">
                <i class="fas fa-arrow-left mr-2"></i> Back to Home
            </a>
        </div>

        <!-- Header -->
        <div class="text-center mb-8">
            <div class="bg-orange-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fas fa-search text-white text-2xl"></i>
            </div>
            <h1 class="text-3xl sm:text-4xl font-montserrat font-bold mb-2">Search Study Materials</h1>
            <p class="text-gray-400">Find content across all AWS services and topics</p>
            <div class="w-24 h-1 bg-orange-600 mx-auto mt-4"></div>
        </div>

        <!-- Search Container -->
        <div class="search-container rounded-lg p-6 max-w-4xl mx-auto mb-8">
            <!-- Search Input -->
            <div class="relative mb-6">
                <input 
                    type="text" 
                    id="searchInput" 
                    placeholder="Search for AWS concepts, services, features..." 
                    class="w-full px-4 py-3 pl-12 bg-gray-800 border border-gray-600 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-500 focus:ring-opacity-50"
                >
                <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>

            <!-- Search Stats -->
            <div id="searchStats" class="text-sm text-gray-400 mb-4 hidden">
                Found <span id="resultCount">0</span> results in <span id="searchTime">0</span>ms
            </div>

            <!-- Search Results -->
            <div id="searchResults" class="space-y-4">
                <div class="text-center text-gray-400 py-8">
                    <i class="fas fa-search text-4xl mb-4 opacity-50"></i>
                    <p>Start typing to search through all study materials...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Content index for all study materials
        const contentIndex = [
            // S3 Service
            { title: "S3 Core Concepts", service: "S3", path: "S3/S3-Core-Concepts.html", keywords: "s3 simple storage service buckets objects versioning access control encryption kms sse" },
            { title: "S3 Performance & Tiers", service: "S3", path: "S3/S3-Performance-and-Tiers.html", keywords: "s3 storage classes lifecycle management replication performance optimization intelligent tiering glacier" },
            { title: "S3 Service Limitations", service: "S3", path: "S3/S3-Service-Limitations.html", keywords: "s3 limits quotas constraints bucket object size multipart upload" },
            { title: "S3 Service Guide", service: "S3", path: "S3/S3-Service-Guide.html", keywords: "s3 features use cases static website hosting cloudfront integration" },
            { title: "S3 Architecture Diagram", service: "S3", path: "S3/S3-Architecture-Diagram.html", keywords: "s3 architecture data lakes integration patterns multi-tier storage" },
            { title: "S3 Exam Questions", service: "S3", path: "S3/S3-Exam-Questions.html", keywords: "s3 practice questions mcq exam preparation saa-c03" },
            { title: "S3 Backup & Restore", service: "S3", path: "S3/S3-Backup-Restore.html", keywords: "s3 backup versioning cross-region replication disaster recovery" },

            // VPC Service
            { title: "VPC Fundamentals", service: "VPC", path: "VPC/vpc-fundamentals.html", keywords: "vpc virtual private cloud cidr blocks networking fundamentals subnets" },
            { title: "VPC Subnets", service: "VPC", path: "VPC/subnets.html", keywords: "vpc subnets public private availability zones subnet configuration" },
            { title: "VPC Gateways", service: "VPC", path: "VPC/gateways.html", keywords: "vpc internet gateway nat gateway nat instance connectivity" },
            { title: "VPC Security", service: "VPC", path: "VPC/security.html", keywords: "vpc security groups nacls network acls firewall stateful stateless" },
            { title: "VPC Route Tables", service: "VPC", path: "VPC/route-tables.html", keywords: "vpc route tables routing rules traffic flow management" },
            { title: "VPC Connectivity", service: "VPC", path: "VPC/connectivity.html", keywords: "vpc peering transit gateway inter-vpc connectivity endpoints" },
            { title: "VPC Hybrid Connectivity", service: "VPC", path: "VPC/hybrid-connectivity.html", keywords: "vpc vpn site-to-site client vpn direct connect hybrid" },
            { title: "VPC Service Limitations", service: "VPC", path: "VPC/vpc-service-limitations.html", keywords: "vpc limits quotas constraints service limits" },
            { title: "VPC Questions & Answers", service: "VPC", path: "VPC/questions-answers.html", keywords: "vpc practice questions exam preparation networking" },

            // RDS, Aurora & ElastiCache
            { title: "RDS Fundamentals", service: "RDS", path: "RDS/RDS-Fundamentals.html", keywords: "rds relational database service engines instance types multi-az storage" },
            { title: "Aurora Deep Dive", service: "RDS", path: "RDS/Aurora-Deep-Dive.html", keywords: "aurora serverless global database high performance mysql postgresql" },
            { title: "ElastiCache Deep Dive", service: "RDS", path: "RDS/ElastiCache-Deep-Dive.html", keywords: "elasticache redis memcached in-memory caching clustering" },
            { title: "Database Security & Encryption", service: "RDS", path: "RDS/Database-Security-Encryption.html", keywords: "database security encryption iam integration vpc security compliance" },
            { title: "Database Monitoring & Performance", service: "RDS", path: "RDS/Database-Monitoring-Performance.html", keywords: "database monitoring cloudwatch performance insights optimization" },
            { title: "Database Migration & DMS", service: "RDS", path: "RDS/Database-Migration-DMS.html", keywords: "database migration dms sct homogeneous heterogeneous" },
            { title: "Database Backup & Recovery", service: "RDS", path: "RDS/Database-Backup-Recovery.html", keywords: "database backup automated snapshots point-in-time recovery disaster recovery" },
            { title: "Database Service Limitations", service: "RDS", path: "RDS/Database-Service-Limitations.html", keywords: "rds aurora elasticache limits quotas constraints" },
            { title: "Database Exam Questions", service: "RDS", path: "RDS/Database-Exam-Questions.html", keywords: "database practice questions rds aurora elasticache exam" },
            { title: "Database Selection Guide", service: "RDS", path: "RDS/Database-Selection-Guide.html", keywords: "database selection rds aurora decision matrix use cases" },
            { title: "Cache Selection Guide", service: "RDS", path: "RDS/Cache-Selection-Guide.html", keywords: "cache selection redis valkey memcached comparison" },
            { title: "RDS Proxy Deep Dive", service: "RDS", path: "RDS/RDS-Proxy-Deep-Dive.html", keywords: "rds proxy connection pooling lambda integration failover" },
            { title: "Parameter Groups Deep Dive", service: "RDS", path: "RDS/Parameter-Groups-Deep-Dive.html", keywords: "parameter groups database configuration performance tuning" },

            // EBS Service
            { title: "EBS Volume Types", service: "EBS", path: "EBS/EBS-Volume-Types.html", keywords: "ebs volume types gp3 gp2 io2 io1 st1 sc1 performance characteristics" },
            { title: "EBS Performance", service: "EBS", path: "EBS/EBS-Performance.html", keywords: "ebs performance iops throughput optimization ebs-optimized monitoring" },
            { title: "EBS Snapshots", service: "EBS", path: "EBS/EBS-Snapshots.html", keywords: "ebs snapshots backup recovery cross-region fast snapshot restore" },
            { title: "EBS Encryption", service: "EBS", path: "EBS/EBS-Encryption.html", keywords: "ebs encryption kms at rest in transit security" },
            { title: "EBS Multi-Attach", service: "EBS", path: "EBS/EBS-Multi-Attach.html", keywords: "ebs multi-attach shared storage clustering file system" },
            { title: "EBS Service Limitations", service: "EBS", path: "EBS/EBS-Service-Limitations.html", keywords: "ebs limits quotas constraints volume size performance" },
            { title: "EBS Use Cases", service: "EBS", path: "EBS/EBS-Use-Cases.html", keywords: "ebs use cases databases file systems boot volumes applications" },

            // High Availability & Scalability
            { title: "ELB Fundamentals", service: "HA & Scalability", path: "High-Availability-Scalability/ELB-Fundamentals.html", keywords: "elb elastic load balancer alb nlb gwlb routing algorithms" },
            { title: "Auto Scaling Groups", service: "HA & Scalability", path: "High-Availability-Scalability/Auto-Scaling-Groups.html", keywords: "asg auto scaling groups scaling policies launch templates health checks" },
            { title: "Multi-AZ Deployments", service: "HA & Scalability", path: "High-Availability-Scalability/Multi-AZ-Deployments.html", keywords: "multi-az availability zones failover disaster recovery strategies" },
            { title: "HA & Scalability Architecture", service: "HA & Scalability", path: "High-Availability-Scalability/HA-Scalability-Architecture.html", keywords: "high availability scalability architecture patterns best practices" },
            { title: "HA & Scalability Service Limitations", service: "HA & Scalability", path: "High-Availability-Scalability/HA-Scalability-Service-Limitations.html", keywords: "elb asg high availability limits quotas constraints" },
            { title: "HA & Scalability Exam Questions", service: "HA & Scalability", path: "High-Availability-Scalability/HA-Scalability-Exam-Questions.html", keywords: "high availability scalability practice questions exam elb asg" },
            { title: "HA & Scalability Service Guide", service: "HA & Scalability", path: "High-Availability-Scalability/HA-Scalability-Service-Guide.html", keywords: "high availability scalability service guide features use cases" },

            // Route 53
            { title: "DNS Fundamentals", service: "Route 53", path: "Route53/dns-fundamentals.html", keywords: "dns fundamentals record types ttl resolution process route53" },
            { title: "Hosted Zones", service: "Route 53", path: "Route53/hosted-zones.html", keywords: "hosted zones public private split-view dns management" },
            { title: "Routing Policies", service: "Route 53", path: "Route53/routing-policies.html", keywords: "routing policies simple weighted latency geolocation failover" },
            { title: "Health Checks", service: "Route 53", path: "Route53/health-checks.html", keywords: "health checks monitoring failover endpoint calculated cloudwatch" },
            { title: "Domain Registration", service: "Route 53", path: "Route53/domain-registration.html", keywords: "domain registration transfer privacy protection management" },
            { title: "Advanced Features", service: "Route 53", path: "Route53/advanced-features.html", keywords: "resolver dnssec traffic flow dns firewall advanced features" },
            { title: "Route 53 Service Limitations", service: "Route 53", path: "Route53/service-limitations.html", keywords: "route53 dns limits quotas constraints hosted zones" },
            { title: "Route 53 Questions & Answers", service: "Route 53", path: "Route53/questions-answers.html", keywords: "route53 dns practice questions exam preparation" },

            // EC2 Service
            { title: "EC2 Fundamentals", service: "EC2", path: "EC2/EC2-Fundamentals.html", keywords: "ec2 elastic compute cloud instances ami security groups key pairs" },
            { title: "EC2 Instance Types Deep Dive", service: "EC2", path: "EC2/EC2-Instance-Types-Deep-Dive.html", keywords: "ec2 instance types general purpose compute optimized memory optimized" },
            { title: "EC2 Storage Deep Dive", service: "EC2", path: "EC2/EC2-Storage-Deep-Dive.html", keywords: "ec2 storage ebs instance store root volumes" },
            { title: "EC2 Networking & VPC", service: "EC2", path: "EC2/EC2-Networking-VPC.html", keywords: "ec2 networking vpc elastic ip placement groups enhanced networking" },
            { title: "EC2 Pricing and Flexibility", service: "EC2", path: "EC2/EC2-Pricing-and-Flexibility.html", keywords: "ec2 pricing on-demand reserved spot savings plans" },
            { title: "EC2 Monitoring & Troubleshooting", service: "EC2", path: "EC2/EC2-Monitoring-Troubleshooting.html", keywords: "ec2 monitoring cloudwatch troubleshooting performance" },
            { title: "EC2 Service Limitations", service: "EC2", path: "EC2/EC2-Service-Limitations.html", keywords: "ec2 limits quotas constraints instance limits" },
            { title: "EC2 Service Guide", service: "EC2", path: "EC2/EC2-Service-Guide.html", keywords: "ec2 service guide features use cases best practices" },
            { title: "EC2 Architecture Diagram", service: "EC2", path: "EC2/EC2-Architecture-Diagram.html", keywords: "ec2 architecture diagrams patterns deployment" },
            { title: "EC2 Backup & Restore", service: "EC2", path: "EC2/EC2-Backup-Restore.html", keywords: "ec2 backup restore snapshots ami disaster recovery" },
            { title: "EC2 Exam Questions", service: "EC2", path: "EC2/EC2-Exam-Questions.html", keywords: "ec2 practice questions exam preparation saa-c03" },

            // IAM Service
            { title: "IAM Fundamentals", service: "IAM", path: "IAM/IAM-Fundamentals.html", keywords: "iam identity access management users groups roles policies" },
            { title: "IAM Policies Deep Dive", service: "IAM", path: "IAM/IAM-Policies-Deep-Dive.html", keywords: "iam policies json policy evaluation conditions" },
            { title: "IAM Roles & Cross Account", service: "IAM", path: "IAM/IAM-Roles-Cross-Account.html", keywords: "iam roles cross-account access assume role trust policies" },
            { title: "IAM Identity Federation", service: "IAM", path: "IAM/IAM-Identity-Federation.html", keywords: "iam identity federation saml oidc cognito sso" },
            { title: "IAM Security and Governance", service: "IAM", path: "IAM/IAM-Security-and-Governance.html", keywords: "iam security governance mfa password policies access analyzer" },
            { title: "IAM Monitoring & Auditing", service: "IAM", path: "IAM/IAM-Monitoring-Auditing.html", keywords: "iam monitoring auditing cloudtrail access logs" },
            { title: "IAM Service Limitations", service: "IAM", path: "IAM/IAM-Service-Limitations.html", keywords: "iam limits quotas constraints policy size" },
            { title: "IAM Service Guide", service: "IAM", path: "IAM/IAM-Service-Guide.html", keywords: "iam service guide features best practices" },
            { title: "IAM Security Diagram", service: "IAM", path: "IAM/IAM-Security-Diagram.html", keywords: "iam security diagrams architecture patterns" },
            { title: "IAM Architecture Questions", service: "IAM", path: "IAM/IAM-Architecture-Questions.html", keywords: "iam architecture questions scenarios" },
            { title: "IAM Exam Questions", service: "IAM", path: "IAM/IAM-Exam-Questions.html", keywords: "iam practice questions exam preparation security" }
        ];

        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const searchStats = document.getElementById('searchStats');
        const resultCount = document.getElementById('resultCount');
        const searchTime = document.getElementById('searchTime');

        let searchTimeout;

        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                performSearch(this.value.trim());
            }, 300);
        });

        function performSearch(query) {
            const startTime = performance.now();
            
            if (!query) {
                showEmptyState();
                return;
            }

            // Search in indexed content first
            const indexResults = contentIndex.filter(item => {
                const searchText = `${item.title} ${item.service} ${item.keywords}`.toLowerCase();
                return searchText.includes(query.toLowerCase());
            });

            // Also search page content dynamically
            searchPageContent(query, indexResults, startTime);
        }

        async function searchPageContent(query, indexResults, startTime) {
            const allResults = [...indexResults];
            const searchPromises = [];

            // Search through pages not already in results
            const notInResults = contentIndex.filter(item => 
                !indexResults.some(result => result.path === item.path)
            );

            for (const item of notInResults.slice(0, 20)) { // Limit concurrent requests
                searchPromises.push(searchInPage(item, query));
            }

            try {
                const pageResults = await Promise.all(searchPromises);
                const foundInPages = pageResults.filter(result => result !== null);
                allResults.push(...foundInPages);
            } catch (error) {
                console.log('Some pages could not be searched:', error);
            }

            const endTime = performance.now();
            const searchDuration = Math.round(endTime - startTime);
            displayResults(allResults, query, searchDuration);
        }

        async function searchInPage(item, query) {
            try {
                const response = await fetch(item.path);
                if (!response.ok) return null;
                
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                
                // Extract text content, excluding scripts and styles
                const textContent = doc.body ? doc.body.innerText.toLowerCase() : '';
                
                if (textContent.includes(query.toLowerCase())) {
                    // Find context around the match
                    const index = textContent.indexOf(query.toLowerCase());
                    const start = Math.max(0, index - 100);
                    const end = Math.min(textContent.length, index + 100);
                    const context = textContent.substring(start, end).trim();
                    
                    return {
                        ...item,
                        context: context,
                        matchType: 'content'
                    };
                }
                return null;
            } catch (error) {
                return null;
            }
        }

        function displayResults(results, query, duration) {
            resultCount.textContent = results.length;
            searchTime.textContent = duration;
            searchStats.classList.remove('hidden');

            if (results.length === 0) {
                searchResults.innerHTML = `
                    <div class="text-center text-gray-400 py-8">
                        <i class="fas fa-search-minus text-4xl mb-4 opacity-50"></i>
                        <p>No results found for "${query}"</p>
                        <p class="text-sm mt-2">Try different keywords or check spelling</p>
                    </div>
                `;
                return;
            }

            const resultsHTML = results.map(result => {
                const highlightedTitle = highlightText(result.title, query);
                let description = '';
                
                if (result.context) {
                    // Show context from page content
                    description = `...${highlightText(result.context, query)}...`;
                } else {
                    // Show keywords
                    description = `Related topics: ${highlightText(result.keywords, query)}`;
                }
                
                const matchBadge = result.matchType === 'content' ? 
                    '<span class="bg-green-600 text-white px-2 py-1 rounded text-xs mr-2">Content Match</span>' : '';
                
                return `
                    <div class="search-result rounded-lg p-4 cursor-pointer" onclick="window.open('${result.path}', '_blank')">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <div class="flex items-center mb-2">
                                    ${matchBadge}
                                    <span class="bg-orange-600 text-white px-2 py-1 rounded text-xs font-semibold mr-3">${result.service}</span>
                                    <h3 class="text-lg font-semibold text-white">${highlightedTitle}</h3>
                                </div>
                                <p class="text-gray-300 text-sm mb-2">${description}</p>
                                <p class="text-gray-400 text-xs">Click to open in new tab</p>
                            </div>
                            <i class="fas fa-external-link-alt text-gray-400 ml-4"></i>
                        </div>
                    </div>
                `;
            }).join('');

            searchResults.innerHTML = resultsHTML;
        }

        function highlightText(text, query) {
            if (!query) return text;
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        function showEmptyState() {
            searchStats.classList.add('hidden');
            searchResults.innerHTML = `
                <div class="text-center text-gray-400 py-8">
                    <i class="fas fa-search text-4xl mb-4 opacity-50"></i>
                    <p>Start typing to search through all study materials...</p>
                </div>
            `;
        }

        // Focus search input on page load
        searchInput.focus();
    </script>
</body>
</html>